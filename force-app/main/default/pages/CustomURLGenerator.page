<apex:page controller="CustomURLGeneratorController" tabStyle="BWP_Transaction__c" sidebar="false">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        <head>
            <apex:slds />  
            <script src="{!URLFOR($Resource.Breadwinner_Payments,'Breadwinner_Payments/js/jquery-3.5.1.min.js')}"></script>
            <apex:variable value="{!OR($User.UIThemeDisplayed == 'Theme4d', $User.UIThemeDisplayed == 'Theme4t')}" var="isLightning" />   
                
                <script>
                var j$ = jQuery.noConflict();
            
            function HideStyleSheet() {
                j$("link.user[href$='elements.css']").each(function() {
                    j$(this).removeAttr("href");
                });
            }
            
            function message() {
                j$(".infoM6, .infoM4, .infoM3, .infoM2, .infoS1").addClass("slds-notify slds-notify_alert slds-theme_inverse-text  slds-text-align_left slds-text-heading_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px","justify-content":"left", "background":"rgba(84,105,141,.95)"} );
                j$(".errorM6, .errorM4, .errorM3, .errorM2, .errorS1").addClass("slds-notify slds-notify_alert slds-theme_error  slds-text-align_left slds-text-heading_small slds-m-bottom_small").css({"font-weight":"500","line-height":"1.4","word-spacing":"1px","justify-content":"left"});
                j$(".warningM6, .warningM4, .warningM3, .warningM2, .warningS1").addClass("slds-notify slds-notify_alert slds-theme_warning  slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px","justify-content":"left"}) ;
                j$(".confirmM6, .confirmM4, .confirmM3, .confirmM2, .confirmS1").addClass("slds-notify slds-notify_alert slds-theme_success slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px","justify-content":"left"} ) ;
                
                j$("div .messageText h4").css( "color", "white" );
                j$("div[class*='warning'] div.messageText h4").css( "color", "black" );
                j$("table.messageTable td").css({"color" : "white"});
                j$("div[class*='warning'] table.messageTable td").css( "color", "black" );
            }
            j$(function() {
                HideStyleSheet();
                message();
            });
            </script>
            <style>
                .message .messageText {
                margin: 0px;
                }
                
                .message .messageText h4 {
                font-weight: inherit;
                display: initial;
                }
                .slds-scope .slds-page-header{
                border:0px;
                border-bottom: 1px solid #d8dde6;
                background: #f7f9fb;
                }
                .slds-scope .slds-page-header__title{
                font-weight: normal;
                }
                .slds-scope .slds-section-title_divider{
                background: #f4f6f9;
                }
            </style>
        </head>
        <body>
            
            <!-- -----------------------------header start ---------------------------->
            <div class="slds-page-header slds-m-bottom_medium" role="banner">
                <div class="slds-media slds-media_center">
                    <div class="slds-media__body">
                        <p class="slds-page-header__title slds-truncate" title="Custom URL Generation">Custom URL Generation</p>
                        <p class="slds-text-body_small">Breadwinner â€¢ Payments</p>
                    </div>
                </div>
            </div>
            <!-- -----------------------------header END ---------------------------->            
            <apex:form >                
                <apex:pagemessages id="pgMsgs"></apex:pagemessages>
                
                <apex:outputPanel layout="block" styleClass="slds-m-bottom_medium" rendered="{!isProcessorConnected}">
                    <apex:outputPanel layout="block"  rendered="{!showOriginatingObjects}">
                        <h3 class="slds-section-title_divider">Select Originating Object</h3>
                        <div class="slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_6-of-12 slds-m-horizontal_small">
                            <div class="slds-form-element slds-m-top_medium slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12">
                                <label class="slds-form-element__label">Select the object from which you want to create a Transaction <abbr class="slds-required" title="required"> *</abbr></label>
                                <div class="slds-form-element__control">
                                    <div class="slds-select_container">
                                        <apex:selectList value="{!selectedObject}" size="1" styleClass="slds-select" >
                                            <apex:selectOption value="{!null}"></apex:selectOption>
                                            <apex:selectOptions value="{!objectNames}" />
                                        </apex:selectList>
                                    </div>   
                                </div>
                            </div>
                        </div>
                    </apex:outputPanel>

                    <apex:outputPanel layout="block" rendered="{!showFieldsMapping}" >
                        <h3 class="slds-section-title_divider">Map Transaction fields with {!ParentObjectName} fields</h3>
                        <div class="slds-grid slds-wrap slds-m-horizontal_small">
                            <div class="slds-col slds-size_1-of-2 slds-medium-size_1-of-2 slds-large-size_6-of-12">
                                <apex:outputPanel layout="block" styleClass ="slds-form-element slds-m-top_small slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12">
                                    <label class="slds-form-element__label">
                                        Select a field for Salesforce {!customerMatchType} <abbr class="slds-required" title="required"> *</abbr>
                                    </label>                                    
                                    <div class="slds-form-element__control">
                                        <div class="slds-select_container">
                                            <apex:selectList id="SF_Parent_Id" value="{!parent_object_reference}" label="Select a field for Salesforce Account" size="1"  styleClass="slds-select">                        
                                                <apex:selectOption value="{!null}"></apex:selectOption>
                                                <apex:selectOptions value="{!AccountReferenceFields}" rendered="{!customerMatchType == 'Account'}" />
                                                <apex:selectOptions value="{!contactReferenceFields}" rendered="{!customerMatchType == 'Contact'}" />
                                            </apex:selectList>
                                        </div>
                                    </div>
                                </apex:outputPanel>                                
                                <div class="slds-form-element slds-m-top_small slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12">
                                    <label class="slds-form-element__label">Select a field for Payment Amount</label>
                                    <div class="slds-form-element__control">
                                        <div class="slds-select_container">
                                            <apex:selectList id="Payment_Amount" value="{!payment_amount}" size="1" styleClass="slds-select">
                                                <apex:selectOption value="{!null}"></apex:selectOption>
                                                <apex:selectOptions value="{!sobjectNumberFields}" />
                                            </apex:selectList>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form-element slds-m-top_small slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12">
                                    <label class="slds-form-element__label">Select a field for Payment Currency</label>
                                    <div class="slds-form-element__control">
                                        <div class="slds-select_container">
                                            <apex:selectList id="Payment_Currency" value="{!payment_currency}" size="1" styleClass="slds-select">
                                                <apex:selectOption value="{!null}"></apex:selectOption>
                                                <apex:selectOptions value="{!sobjectTextFields}" />
                                            </apex:selectList>
                                        </div>
                                    </div>
                                </div>
                                <div class="slds-form-element slds-m-top_small slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12">
                                    <label class="slds-form-element__label">Select a field for Payment Description</label>
                                    <div class="slds-form-element__control">
                                        <div class="slds-select_container">
                                            <apex:selectList id="Payment_Description" value="{!payment_description}" size="1" styleClass="slds-select">
                                                <apex:selectOption value="{!null}"></apex:selectOption>
                                                <apex:selectOptions value="{!sobjectTextFields}" />
                                            </apex:selectList>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </apex:outputPanel> 
                    
                   
                    <div align="center" class="slds-m-bottom_medium slds-m-top_medium">
                        <apex:commandButton value="Next" styleClass="slds-button slds-button_brand" action="{!parentObjectFields}" rendered="{!showOriginatingObjects}"/>
                        <apex:commandButton value="Go Back" styleClass="slds-button slds-button_neutral" action="{!goBack}" rendered="{!showFieldsMapping}" />
                        <apex:commandButton value="Generate URL" styleClass="slds-button slds-button_brand" action="{!generateURL}" rendered="{!showFieldsMapping}"/>
                    </div>
                    
                    <apex:outputPanel layout="block" rendered="{!showURLBlock}">
                        <h3 class="slds-section-title_divider">Custom URL for new Button</h3>
                        <div class="slds-col_padded slds-size_1-of-2 slds-medium-size_3-of-6 slds-large-size_6-of-12">
                            <div class="slds-form-element slds-m-top_medium">
                                <label class="slds-form-element__label" >Copy and Paste the following URL in the Custom Button (New Customer)</label>
                                <div class="slds-form-element__control">
                                    <apex:inputTextarea id="url" onfocus="this.select();" styleClass="slds-textarea" cols="120" rows="8" value="{!url}"/>
                                </div>
                                <div class="slds-text-body_small  slds-m-left_medium slds-m-top_small">
                                    To preview this information, append <b>&amp;testing=true</b> to the end of the URL.
                                </div>
                            </div>
                        </div>
                    </apex:outputPanel>
                </apex:outputPanel>
            </apex:form>
        </body>
    </html>    
</apex:page>